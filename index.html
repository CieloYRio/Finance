<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prospira Finance Management System 2025</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e40af',
                        secondary: '#3b82f6',
                        accent: '#0ea5e9',
                        success: '#059669',
                        warning: '#d97706',
                        danger: '#dc2626',
                        dark: '#1f2937',
                        light: '#f8fafc'
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-button.active { 
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(30, 64, 175, 0.3);
        }
        .editable-cell { 
            cursor: pointer; 
            transition: all 0.2s ease;
        }
        .editable-cell:hover { 
            background-color: #f1f5f9; 
            transform: translateY(-1px);
        }
        .editing { 
            background-color: #dbeafe !important; 
            box-shadow: 0 0 0 2px #3b82f6;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
        }
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        .metric-card {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            border-radius: 16px;
            padding: 24px;
            color: white;
            box-shadow: 0 10px 30px rgba(30, 64, 175, 0.3);
            transition: transform 0.3s ease;
        }
        .metric-card:hover {
            transform: translateY(-5px);
        }
        .sidebar {
            background: linear-gradient(180deg, #1f2937 0%, #111827 100%);
            min-height: 100vh;
            width: 280px;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 1000;
            transition: transform 0.3s ease;
            overflow-y: auto;
            overflow-x: hidden;
            max-height: 100vh;
        }
        .sidebar-content {
            height: calc(100vh - 140px);
            overflow-y: auto;
            overflow-x: hidden;
            padding-bottom: 20px;
            scrollbar-width: thin;
            scrollbar-color: #4b5563 #1f2937;
        }
        
        .sidebar-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .sidebar-content::-webkit-scrollbar-track {
            background: #1f2937;
        }
        
        .sidebar-content::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 3px;
        }
        
        .sidebar-content::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }
        .main-content {
            margin-left: 280px;
            min-height: 100vh;
            background: linear-gradient(135deg, #f8fafc 0%, #e1e7ef 100%);
        }
        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            margin: 4px 12px;
            border-radius: 12px;
            color: #9ca3af;
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        .nav-item:hover, .nav-item.active {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
            transform: translateX(5px);
        }
        .nav-item i {
            width: 20px;
            margin-right: 12px;
        }
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.open {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body class="font-sans bg-light">
    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar">
        <div class="p-6 border-b border-gray-700">
            <h1 class="text-xl font-bold text-white">Prospira</h1>
            <p class="text-gray-400 text-sm mt-1">Simplifying Finance for Growth and Clarity</p>
            
            <!-- Company Section -->
            <div class="mt-4 p-3 bg-gray-800 rounded-lg">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wide">Company</p>
                        <p class="text-white font-medium" id="companyName">Click to set company name</p>
                    </div>
                    <button onclick="editCompanyName()" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fas fa-edit text-sm"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="sidebar-content">
            <!-- CORE DASHBOARD -->
            <a href="#" class="nav-item active" onclick="showTab('dashboard')">
                <i class="fas fa-chart-line"></i>
                Dashboard
            </a>
            
            <!-- DATA ENTRY SECTION -->
            <div class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">Data Entry</div>
            <a href="#" class="nav-item" onclick="showTab('project-profile')">
                <i class="fas fa-project-diagram"></i>
                Project Profile
            </a>
            <a href="#" class="nav-item" onclick="showTab('transaction-masters')">
                <i class="fas fa-exchange-alt"></i>
                Transaction Masters
            </a>
            <a href="#" class="nav-item" onclick="showTab('collections-master')">
                <i class="fas fa-coins"></i>
                Collections Master
            </a>
            <a href="#" class="nav-item" onclick="showTab('reference-table')">
                <i class="fas fa-table"></i>
                Reference Table
            </a>
            
            <!-- PROJECT ANALYSIS -->
            <div class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider mt-4">Project Analysis</div>
            <a href="#" class="nav-item" onclick="showTab('project-revenue')">
                <i class="fas fa-money-bill-wave"></i>
                Project Revenue
            </a>
            <a href="#" class="nav-item" onclick="showTab('project-cost')">
                <i class="fas fa-calculator"></i>
                Project Cost
            </a>
            <a href="#" class="nav-item" onclick="showTab('budget-actual')">
                <i class="fas fa-balance-scale"></i>
                Budget vs Actual
            </a>
            
            <!-- FINANCIAL STATEMENTS -->
            <div class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider mt-4">Financial Statements</div>
            <a href="#" class="nav-item" onclick="showTab('profit-loss')">
                <i class="fas fa-chart-bar"></i>
                Profit & Loss
            </a>
            <a href="#" class="nav-item" onclick="showTab('balance-sheet')">
                <i class="fas fa-balance-scale-right"></i>
                Balance Sheet
            </a>
            <a href="#" class="nav-item" onclick="showTab('cash-flow')">
                <i class="fas fa-water"></i>
                Cash Flow Statement
            </a>
            
            <!-- REPORTS -->
            <div class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider mt-4">Reports</div>
            <a href="#" class="nav-item" onclick="showTab('financial-reports')">
                <i class="fas fa-chart-area"></i>
                Financial Reports
            </a>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <header class="glass-card border-b p-6 sticky top-0 z-50">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <button onclick="toggleSidebar()" class="lg:hidden mr-4 p-2 rounded-lg hover:bg-gray-100">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900" id="pageTitle">Dashboard</h2>
                        <p class="text-gray-600 text-sm">Real-time financial insights and analytics</p>
                    </div>
                </div>
                <div class="flex gap-3">
                    <button onclick="importExcel()" class="bg-success hover:bg-green-600 text-white px-6 py-3 rounded-xl flex items-center gap-2 shadow-lg transition-all duration-300 hover:shadow-xl">
                        <i class="fas fa-file-import"></i>
                        Import Excel
                    </button>
                    <button onclick="exportExcel()" class="bg-primary hover:bg-indigo-600 text-white px-6 py-3 rounded-xl flex items-center gap-2 shadow-lg transition-all duration-300 hover:shadow-xl">
                        <i class="fas fa-file-export"></i>
                        Export Excel
                    </button>
                </div>
            </div>
        </header>

        <!-- Tab Content -->
        <main class="p-6">
            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content active">
                <!-- Key Metrics -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="metric-card">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/80 text-sm font-medium">Total Revenue</p>
                                <p class="text-3xl font-bold mt-2" id="totalRevenue">₱0.00</p>
                            </div>
                            <i class="fas fa-chart-line text-3xl text-white/60"></i>
                        </div>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #059669 0%, #047857 100%);">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/80 text-sm font-medium">Total Collections</p>
                                <p class="text-3xl font-bold mt-2" id="totalCollections">₱0.00</p>
                            </div>
                            <i class="fas fa-coins text-3xl text-white/60"></i>
                        </div>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/80 text-sm font-medium">Total Expenses</p>
                                <p class="text-3xl font-bold mt-2" id="totalExpenses">₱0.00</p>
                            </div>
                            <i class="fas fa-credit-card text-3xl text-white/60"></i>
                        </div>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/80 text-sm font-medium">Net Profit</p>
                                <p class="text-3xl font-bold mt-2" id="netProfit">₱0.00</p>
                            </div>
                            <i class="fas fa-trophy text-3xl text-white/60"></i>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="glass-card rounded-2xl p-6 shadow-xl">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">Monthly Revenue vs Expenses</h3>
                        <div class="chart-container">
                            <canvas id="monthlyChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="glass-card rounded-2xl p-6 shadow-xl">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">Project Profitability</h3>
                        <div class="chart-container">
                            <canvas id="projectChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Transaction Masters Tab -->
            <div id="transaction-masters" class="tab-content">
                <div class="glass-card rounded-2xl p-6 shadow-xl">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Transaction Masters</h2>
                        <div class="flex gap-3">
                            <button onclick="addTransaction()" class="bg-primary hover:bg-indigo-600 text-white px-6 py-3 rounded-xl shadow-lg transition-all duration-300">
                                <i class="fas fa-plus mr-2"></i>Add Transaction
                            </button>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Date</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Description</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Amount</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Project</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="transactionTable">
                                <!-- Transactions will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Collections Master Tab -->
            <div id="collections-master" class="tab-content">
                <div class="glass-card rounded-2xl p-6 shadow-xl">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Collections Master</h2>
                        <div class="flex gap-3">
                            <button onclick="addCollection()" class="bg-success hover:bg-green-600 text-white px-6 py-3 rounded-xl shadow-lg transition-all duration-300">
                                <i class="fas fa-plus mr-2"></i>Add Collection
                            </button>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Date</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Client</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Amount</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Project</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="collectionTable">
                                <!-- Collections will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Project Profile Tab -->
            <div id="project-profile" class="tab-content">
                <div class="glass-card rounded-2xl p-6 shadow-xl">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Project Profile</h2>
                        <div class="flex gap-3">
                            <button onclick="addProject()" class="bg-primary hover:bg-indigo-600 text-white px-6 py-3 rounded-xl shadow-lg transition-all duration-300">
                                <i class="fas fa-plus mr-2"></i>Add Project
                            </button>
                        </div>
                    </div>
                    
                    <div id="projectCards" class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                        <!-- Project cards will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Reference Table Tab -->
            <div id="reference-table" class="tab-content">
                <div class="glass-card rounded-2xl p-6 shadow-xl">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Reference Tables</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Chart of Accounts</h3>
                            <div class="space-y-2">
                                <div class="p-3 bg-gray-50 rounded-lg">
                                    <span class="font-medium">100 - Cash in Bank</span>
                                </div>
                                <div class="p-3 bg-gray-50 rounded-lg">
                                    <span class="font-medium">400 - Service Income</span>
                                </div>
                                <div class="p-3 bg-gray-50 rounded-lg">
                                    <span class="font-medium">500.1 - Materials</span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Project Types</h3>
                            <div class="space-y-2">
                                <div class="p-3 bg-gray-50 rounded-lg">Design</div>
                                <div class="p-3 bg-gray-50 rounded-lg">Build</div>
                                <div class="p-3 bg-gray-50 rounded-lg">Fit Out</div>
                                <div class="p-3 bg-gray-50 rounded-lg">Renovation</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Project Revenue Tab -->
            <div id="project-revenue" class="tab-content">
                <div class="glass-card rounded-2xl p-6 shadow-xl">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Project Revenue</h2>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Project</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Client</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Revenue</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Status</th>
                                </tr>
                            </thead>
                            <tbody id="projectRevenueTable">
                                <!-- Project revenue data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Project Cost Tab -->
            <div id="project-cost" class="tab-content">
                <div class="glass-card rounded-2xl p-6 shadow-xl">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Project Cost</h2>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Project</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Materials</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Labor</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Total Cost</th>
                                </tr>
                            </thead>
                            <tbody id="projectCostTable">
                                <!-- Project cost data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Budget vs Actual Tab -->
            <div id="budget-actual" class="tab-content">
                <div class="glass-card rounded-2xl p-6 shadow-xl">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Budget vs Actual</h2>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Project</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Budget</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Actual</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Variance</th>
                                </tr>
                            </thead>
                            <tbody id="budgetActualTable">
                                <!-- Budget vs actual data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Profit & Loss Tab -->
            <div id="profit-loss" class="tab-content">
                <div class="glass-card rounded-2xl p-6 shadow-xl">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Profit & Loss Statement</h2>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Account</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Current Month</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Year to Date</th>
                                </tr>
                            </thead>
                            <tbody id="profitLossTable">
                                <!-- P&L data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Balance Sheet Tab -->
            <div id="balance-sheet" class="tab-content">
                <div class="glass-card rounded-2xl p-6 shadow-xl">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Balance Sheet</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Assets</h3>
                            <table class="w-full border-collapse">
                                <tbody id="assetsTable">
                                    <tr>
                                        <td class="border border-gray-200 px-4 py-3">Cash in Bank</td>
                                        <td class="border border-gray-200 px-4 py-3">₱0.00</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Liabilities & Equity</h3>
                            <table class="w-full border-collapse">
                                <tbody id="liabilitiesTable">
                                    <tr>
                                        <td class="border border-gray-200 px-4 py-3">Accounts Payable</td>
                                        <td class="border border-gray-200 px-4 py-3">₱0.00</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cash Flow Tab -->
            <div id="cash-flow" class="tab-content">
                <div class="glass-card rounded-2xl p-6 shadow-xl">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Cash Flow Statement</h2>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Category</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Current Month</th>
                                    <th class="border border-gray-200 px-4 py-3 text-left font-semibold">Year to Date</th>
                                </tr>
                            </thead>
                            <tbody id="cashFlowTable">
                                <!-- Cash flow data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Financial Reports Tab -->
            <div id="financial-reports" class="tab-content">
                <div class="glass-card rounded-2xl p-6 shadow-xl">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Financial Reports</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                            <h3 class="text-lg font-semibold mb-4">Project Performance</h3>
                            <p class="text-gray-600 mb-4">Detailed analysis of project profitability</p>
                            <button class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg">
                                Generate Report
                            </button>
                        </div>
                        <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                            <h3 class="text-lg font-semibold mb-4">Monthly Summary</h3>
                            <p class="text-gray-600 mb-4">Month-by-month financial breakdown</p>
                            <button class="w-full bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-lg">
                                Generate Report
                            </button>
                        </div>
                        <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                            <h3 class="text-lg font-semibold mb-4">Tax Compliance</h3>
                            <p class="text-gray-600 mb-4">BIR-ready reports and calculations</p>
                            <button class="w-full bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg">
                                Generate Report
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Hidden file input for Excel import -->
    <input type="file" id="excelFileInput" accept=".xlsx,.xls" style="display: none;" onchange="handleExcelImport(event)">

    <script>
        // Global data storage
        let financeData = {
            companyName: 'Click to set company name',
            transactions: [],
            collections: [],
            projects: [
                { id: 'P1', code: 'LEZ', name: 'Construction of One Storey Stalls', client: 'Mrs. Lina Ecal', type: 'Build', location: 'Botolan Zambales' },
                { id: 'P2', code: 'RHL', name: 'Design for One Storey Coffee Shop', client: 'Ms. Rhea Hachac', type: 'Design', location: 'Laguna' }
            ]
        };

        // Tab management
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked nav item
            event.target.classList.add('active');
            
            // Update page title
            const titles = {
                'dashboard': 'Dashboard',
                'transaction-masters': 'Transaction Masters',
                'collections-master': 'Collections Master',
                'project-profile': 'Project Profile',
                'reference-table': 'Reference Table',
                'project-revenue': 'Project Revenue',
                'project-cost': 'Project Cost',
                'budget-actual': 'Budget vs Actual',
                'profit-loss': 'Profit & Loss',
                'balance-sheet': 'Balance Sheet',
                'cash-flow': 'Cash Flow Statement',
                'financial-reports': 'Financial Reports'
            };
            
            document.getElementById('pageTitle').textContent = titles[tabName] || 'Dashboard';
        }

        // Sidebar toggle for mobile
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        // Company name editing
        function editCompanyName() {
            const currentName = document.getElementById('companyName').textContent;
            const newName = prompt('Enter company name:', currentName);
            if (newName && newName.trim()) {
                financeData.companyName = newName.trim();
                document.getElementById('companyName').textContent = newName.trim();
                showNotification('Company name updated successfully!', 'success');
            }
        }

        // Add functions
        function addTransaction() {
            const date = prompt('Enter transaction date (YYYY-MM-DD):');
            const description = prompt('Enter description:');
            const amount = parseFloat(prompt('Enter amount:'));
            
            if (date && description && amount) {
                const transaction = {
                    id: 'T' + (financeData.transactions.length + 1).toString().padStart(3, '0'),
                    date: date,
                    description: description,
                    amount: amount,
                    project: 'P1'
                };
                
                financeData.transactions.push(transaction);
                populateTransactionTable();
                updateDashboard();
                showNotification('Transaction added successfully!', 'success');
            }
        }

        function addCollection() {
            const date = prompt('Enter collection date (YYYY-MM-DD):');
            const client = prompt('Enter client name:');
            const amount = parseFloat(prompt('Enter amount:'));
            
            if (date && client && amount) {
                const collection = {
                    id: 'C' + (financeData.collections.length + 1).toString().padStart(3, '0'),
                    date: date,
                    client: client,
                    amount: amount,
                    project: 'P1'
                };
                
                financeData.collections.push(collection);
                populateCollectionTable();
                updateDashboard();
                showNotification('Collection added successfully!', 'success');
            }
        }

        function addProject() {
            const name = prompt('Enter project name:');
            const client = prompt('Enter client name:');
            
            if (name && client) {
                const project = {
                    id: 'P' + (financeData.projects.length + 1),
                    code: name.substring(0, 3).toUpperCase(),
                    name: name,
                    client: client,
                    type: 'Design',
                    location: ''
                };
                
                financeData.projects.push(project);
                populateProjectCards();
                showNotification('Project added successfully!', 'success');
            }
        }

        // Populate tables
        function populateTransactionTable() {
            const tbody = document.getElementById('transactionTable');
            tbody.innerHTML = '';
            
            financeData.transactions.forEach(transaction => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td class="border border-gray-200 px-4 py-3">${transaction.date}</td>
                    <td class="border border-gray-200 px-4 py-3">${transaction.description}</td>
                    <td class="border border-gray-200 px-4 py-3">₱${transaction.amount.toFixed(2)}</td>
                    <td class="border border-gray-200 px-4 py-3">${transaction.project}</td>
                    <td class="border border-gray-200 px-4 py-3">
                        <button onclick="deleteTransaction('${transaction.id}')" class="text-red-500 hover:text-red-700">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
            });
        }

        function populateCollectionTable() {
            const tbody = document.getElementById('collectionTable');
            tbody.innerHTML = '';
            
            financeData.collections.forEach(collection => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td class="border border-gray-200 px-4 py-3">${collection.date}</td>
                    <td class="border border-gray-200 px-4 py-3">${collection.client}</td>
                    <td class="border border-gray-200 px-4 py-3">₱${collection.amount.toFixed(2)}</td>
                    <td class="border border-gray-200 px-4 py-3">${collection.project}</td>
                    <td class="border border-gray-200 px-4 py-3">
                        <button onclick="deleteCollection('${collection.id}')" class="text-red-500 hover:text-red-700">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
            });
        }

        function populateProjectCards() {
            const container = document.getElementById('projectCards');
            container.innerHTML = '';
            
            financeData.projects.forEach(project => {
                const card = document.createElement('div');
                card.className = 'bg-white p-6 rounded-xl shadow-lg border border-gray-200';
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800">${project.name}</h3>
                            <p class="text-gray-600">${project.client}</p>
                        </div>
                        <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">${project.type}</span>
                    </div>
                    <div class="space-y-2">
                        <p class="text-sm text-gray-600"><strong>ID:</strong> ${project.id}</p>
                        <p class="text-sm text-gray-600"><strong>Code:</strong> ${project.code}</p>
                        <p class="text-sm text-gray-600"><strong>Location:</strong> ${project.location || 'Not specified'}</p>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Delete functions
        function deleteTransaction(id) {
            if (confirm('Are you sure you want to delete this transaction?')) {
                financeData.transactions = financeData.transactions.filter(t => t.id !== id);
                populateTransactionTable();
                updateDashboard();
                showNotification('Transaction deleted successfully!', 'success');
            }
        }

        function deleteCollection(id) {
            if (confirm('Are you sure you want to delete this collection?')) {
                financeData.collections = financeData.collections.filter(c => c.id !== id);
                populateCollectionTable();
                updateDashboard();
                showNotification('Collection deleted successfully!', 'success');
            }
        }

        // Update dashboard metrics
        function updateDashboard() {
            const totalRevenue = financeData.collections.reduce((sum, c) => sum + c.amount, 0);
            const totalExpenses = financeData.transactions.reduce((sum, t) => sum + t.amount, 0);
            const netProfit = totalRevenue - totalExpenses;
            
            document.getElementById('totalRevenue').textContent = `₱${totalRevenue.toFixed(2)}`;
            document.getElementById('totalCollections').textContent = `₱${totalRevenue.toFixed(2)}`;
            document.getElementById('totalExpenses').textContent = `₱${totalExpenses.toFixed(2)}`;
            document.getElementById('netProfit').textContent = `₱${netProfit.toFixed(2)}`;
        }

        // Excel import/export
        function importExcel() {
            document.getElementById('excelFileInput').click();
        }

        function handleExcelImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet);
                    
                    // Process imported data (simplified)
                    showNotification('Excel file imported successfully!', 'success');
                } catch (error) {
                    showNotification('Error importing Excel file', 'error');
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function exportExcel() {
            const wb = XLSX.utils.book_new();
            
            // Export transactions
            if (financeData.transactions.length > 0) {
                const ws = XLSX.utils.json_to_sheet(financeData.transactions);
                XLSX.utils.book_append_sheet(wb, ws, 'Transactions');
            }
            
            // Export collections
            if (financeData.collections.length > 0) {
                const ws = XLSX.utils.json_to_sheet(financeData.collections);
                XLSX.utils.book_append_sheet(wb, ws, 'Collections');
            }
            
            XLSX.writeFile(wb, 'Prospira_Financial_Data.xlsx');
            showNotification('Data exported successfully!', 'success');
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-500 text-white' :
                type === 'error' ? 'bg-red-500 text-white' :
                'bg-blue-500 text-white'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Initialize charts
        function initializeCharts() {
            // Monthly Revenue vs Expenses Chart
            const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
            new Chart(monthlyCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Revenue',
                        data: [50000, 75000, 60000, 80000, 90000, 85000],
                        borderColor: '#059669',
                        backgroundColor: 'rgba(5, 150, 105, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'Expenses',
                        data: [30000, 45000, 40000, 55000, 60000, 50000],
                        borderColor: '#dc2626',
                        backgroundColor: 'rgba(220, 38, 38, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '₱' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });

            // Project Profitability Chart
            const projectCtx = document.getElementById('projectChart').getContext('2d');
            new Chart(projectCtx, {
                type: 'bar',
                data: {
                    labels: ['P1-LEZ', 'P2-RHL', 'P3-PRP', 'P4-CRV'],
                    datasets: [{
                        label: 'Profit',
                        data: [25000, 15000, 30000, 20000],
                        backgroundColor: [
                            'rgba(30, 64, 175, 0.8)',
                            'rgba(5, 150, 105, 0.8)',
                            'rgba(14, 165, 233, 0.8)',
                            'rgba(168, 85, 247, 0.8)'
                        ],
                        borderColor: [
                            '#1e40af',
                            '#059669',
                            '#0ea5e9',
                            '#a855f7'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '₱' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            populateProjectCards();
            updateDashboard();
            initializeCharts();
            showNotification('Prospira Finance System loaded successfully!', 'success');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9735e16c061bed29',t:'MTc1NTkwMjUxNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
